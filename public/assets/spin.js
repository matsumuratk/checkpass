/**
 * Copyright (c) 2011-2013 Felix Gnass
 * Licensed under the MIT license
 */
!function(e,t){"object"==typeof exports?module.exports=t():"function"==typeof define&&define.amd?define(t):e.Spinner=t()}(this,function(){"use strict";function e(e,t){var i,n=document.createElement(e||"div");for(i in t)n[i]=t[i];return n}function t(e){for(var t=1,i=arguments.length;i>t;t++)e.appendChild(arguments[t]);return e}function i(e,t,i,n){var s=["opacity",t,~~(100*e),i,n].join("-"),o=.01+100*(i/n),r=Math.max(1-(1-e)/t*(100-o),e),a=u.substring(0,u.indexOf("Animation")).toLowerCase(),l=a&&"-"+a+"-"||"";return h[s]||(d.insertRule("@"+l+"keyframes "+s+"{"+"0%{opacity:"+r+"}"+o+"%{opacity:"+e+"}"+(o+.01)+"%{opacity:1}"+(o+t)%100+"%{opacity:"+e+"}"+"100%{opacity:"+r+"}"+"}",d.cssRules.length),h[s]=1),s}function n(e,t){var i,n,s=e.style;if(void 0!==s[t])return t;for(t=t.charAt(0).toUpperCase()+t.slice(1),n=0;n<c.length;n++)if(i=c[n]+t,void 0!==s[i])return i}function s(e,t){for(var i in t)e.style[n(e,i)||i]=t[i];return e}function o(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)void 0===e[n]&&(e[n]=i[n])}return e}function r(e){for(var t={x:e.offsetLeft,y:e.offsetTop};e=e.offsetParent;)t.x+=e.offsetLeft,t.y+=e.offsetTop;return t}function a(e){return"undefined"==typeof this?new a(e):(this.opts=o(e||{},a.defaults,p),void 0)}function l(){function i(t,i){return e("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',i)}d.addRule(".spin-vml","behavior:url(#default#VML)"),a.prototype.lines=function(e,n){function o(){return s(i("group",{coordsize:u+" "+u,coordorigin:-l+" "+-l}),{width:u,height:u})}function r(e,r,a){t(h,t(s(o(),{rotation:360/n.lines*e+"deg",left:~~r}),t(s(i("roundrect",{arcsize:n.corners}),{width:l,height:n.width,left:n.radius,top:-n.width>>1,filter:a}),i("fill",{color:n.color,opacity:n.opacity}),i("stroke",{opacity:0}))))}var a,l=n.length+n.width,u=2*l,c=2*-(n.width+n.length)+"px",h=s(o(),{position:"absolute",top:c,left:c});if(n.shadow)for(a=1;a<=n.lines;a++)r(a,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(a=1;a<=n.lines;a++)r(a);return t(e,h)},a.prototype.opacity=function(e,t,i,n){var s=e.firstChild;n=n.shadow&&n.lines||0,s&&t+n<s.childNodes.length&&(s=s.childNodes[t+n],s=s&&s.firstChild,s=s&&s.firstChild,s&&(s.opacity=i))}}var u,c=["webkit","Moz","ms","O"],h={},d=function(){var i=e("style",{type:"text/css"});return t(document.getElementsByTagName("head")[0],i),i.sheet||i.styleSheet}(),p={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"auto",left:"auto",position:"relative"};a.defaults={},o(a.prototype,{spin:function(t){this.stop();var i,n,o=this,a=o.opts,l=o.el=s(e(0,{className:a.className}),{position:a.position,width:0,zIndex:a.zIndex}),c=a.radius+a.length+a.width;if(t&&(t.insertBefore(l,t.firstChild||null),n=r(t),i=r(l),s(l,{left:("auto"==a.left?n.x-i.x+(t.offsetWidth>>1):parseInt(a.left,10)+c)+"px",top:("auto"==a.top?n.y-i.y+(t.offsetHeight>>1):parseInt(a.top,10)+c)+"px"})),l.setAttribute("role","progressbar"),o.lines(l,o.opts),!u){var h,d=0,p=(a.lines-1)*(1-a.direction)/2,f=a.fps,m=f/a.speed,g=(1-a.opacity)/(m*a.trail/100),v=m/a.lines;!function b(){d++;for(var e=0;e<a.lines;e++)h=Math.max(1-(d+(a.lines-e)*v)%m*g,a.opacity),o.opacity(l,e*a.direction+p,h,a);o.timeout=o.el&&setTimeout(b,~~(1e3/f))}()}return o},stop:function(){var e=this.el;return e&&(clearTimeout(this.timeout),e.parentNode&&e.parentNode.removeChild(e),this.el=void 0),this},lines:function(n,o){function r(t,i){return s(e(),{position:"absolute",width:o.length+o.width+"px",height:o.width+"px",background:t,boxShadow:i,transformOrigin:"left",transform:"rotate("+~~(360/o.lines*l+o.rotate)+"deg) translate("+o.radius+"px"+",0)",borderRadius:(o.corners*o.width>>1)+"px"})}for(var a,l=0,c=(o.lines-1)*(1-o.direction)/2;l<o.lines;l++)a=s(e(),{position:"absolute",top:1+~(o.width/2)+"px",transform:o.hwaccel?"translate3d(0,0,0)":"",opacity:o.opacity,animation:u&&i(o.opacity,o.trail,c+l*o.direction,o.lines)+" "+1/o.speed+"s linear infinite"}),o.shadow&&t(a,s(r("#000","0 0 4px #000"),{top:"2px"})),t(n,t(a,r(o.color,"0 0 1px rgba(0,0,0,.1)")));return n},opacity:function(e,t,i){t<e.childNodes.length&&(e.childNodes[t].style.opacity=i)}});var f=s(e("group"),{behavior:"url(#default#VML)"});return!n(f,"transform")&&f.adj?l():u=n(f,"animation"),a});